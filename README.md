# Конкурсное задание по суперкомпьютерной практике

Тьюторы: И.Н.Коньшин и А.А.Лёгкий
Команды: A, B, C, D (группа 1М-ММ)

# Формулировка задачи диффузии

Рассматривается решением нестационарного уравнения диффузии с неизвестной
U = U(x, y, z, t):

∂U/∂t − ∇(D · gradU) = f(x, y, z, t)

где точка (x, y, z) принадлежит Ω = [0; 1]<sup>3</sup>
, а время t рассматривается
на отрезке [0; T]. Граничные условия: U(x, y, z, t) = g(x, y, z) на границе
области ∂Ω, а начальные условия: U(x, y, z, 0) = 0 в начальный момент
времени t<sub>0</sub> = 0. Конечный момент времени T = 1.

Будем использовать диагональный тензор D:

D = [[d<sub>x</sub>, 0, 0], [0, d<sub>y</sub>, 0], [0, 0, d<sub>z</sub>]]

где d<sub>x</sub> = 0.25, d<sub>y</sub> = 0.15, d<sub>z</sub> = 0.1. Зададим также начально-краевые условия:


g(x, y, z) = 0,

f(x, y, z) = (d<sub>x</sub> + d<sub>y</sub> + d<sub>z</sub>) · π<sup>2</sup> · sin(πx) sin(πy) sin(πz).


Решаемое уравнения имеет аналитическое решение:

U<sup>∗</sup> = sin(πx) sin(πy) sin(πz) · (1 − exp(−(dx + dy + dz) · π<sup>2</sup>t)).

# Дискретизация

Построим в нашей области Ω равномерную сетку, состоящую из параллелепипедов.
Пусть нам заданы количества ячеек N<sub>x</sub>, N<sub>y</sub> и N<sub>z</sub> вдоль каждого из направлений
O<sub>x</sub>, O<sub>y</sub> и O<sub>z</sub>, соответственно. При этом количество узлов вдоль каждого
из направлений будет равно N<sub>x</sub> + 1, N<sub>y</sub> + 1 и N<sub>z</sub> + 1, а шаги сетки будет
равны ∆x = 1/N<sub>x</sub>, ∆y = 1/N<sub>y</sub> и ∆z = 1/N<sub>z</sub>, соответственно.
Обозначим через V<sub>ijk</sub> узел сетки с координатами x<sub>i</sub> = i ∆x, y<sub>j</sub> = j ∆y и
z<sub>k</sub> = k ∆z. Будем описывать дискретную функцию [U]
h в момент времени
n ∆t её степенями свободы, которые расположим в узлах сетки, а степень
свободы в узле Vijk обозначим через U
n
ijk, 0 ⩽ i ⩽ Nx, 0 ⩽ j ⩽ Ny и 0 ⩽
k ⩽ Nz. Дискретизуем наше уравнение по пространству методом конечных
разностей, а по времени явной схемой Эйлера. Заметим, что для такой
дискретизации шаг по времени должен удовлетворять условию Куранта:
∆t < τ ∗ =
1
2

dx
(∆x)
2
+
dy
(∆y)
2
+
dz
(∆z)
2

.
2
Для определенности можно положить ∆t = 0.9τ
∗
.
Введём дискретные операторы вторых пространственных производных:
Lx,ijkU
n = (U
n
i−1,j,k − 2U
n
i,j,k + U
n
i+1,j,k)/(∆x)
2
,
Ly,ijkU
n = (U
n
i,j−1,k − 2U
n
i,j,k + U
n
i,j,k+1)/(∆y)
2
,
Lz,ijkU
n = (U
n
i,j,k−1 − 2U
n
i,j,k + U
n
i,j,k+1)/(∆z)
2
,
а также f
n
i,j,k = f(i ∆x, j ∆y, k ∆z, n ∆t) и gi,j,k = g(i ∆x, j ∆y, k ∆z).
В этих обозначениях во всех внутренних точках численная схема записывается
следующим образом:
U
n+1
ijk = U
n
ijk + ∆t

f
n
ijk + dx Lx, ijkU
n + dy Ly,ijkU
n + dz Lz,ijkU
n

,
т.е., если 1 ⩽ i ⩽ Nx−1, 1 ⩽ j ⩽ Ny−1, 1 ⩽ k ⩽ Nz −1. Во всех граничных
точках значения остаются старыми (функция g от времени не зависит):
U
n+1
ijk = gijk,
т.е., если (i%Nx) · (j%Ny) · (k%Nz) = 0 (это как раз и есть все граничные
точки). Здесь a%b – операция взятия остатка от деления a на b (как это и
делается в языках С и С++)